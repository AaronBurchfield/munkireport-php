option_settings:
  - namespace: 'aws:elasticbeanstalk:container:php:phpini'
    option_name: document_root
    value: /public
  - namespace: aws:elasticbeanstalk:application:environment
    option_name: COMPOSER_HOME
    value: /root

files:
    "/home/ec2-user/config.php" :
      mode: "000755"
      owner: root
      group: root
      content: |
        <?php
        $auth_config['test'] = '$P$BKKa.CtcsHSA0BSvYInJHXBOlroSb1.';

container_commands:
  01-optimize:
       command: "/usr/bin/composer.phar dump-autoload --optimize"
  02_copy_config:
    command: "cp /home/ec2-user/config.php ."
  03_init_db:
    command: "touch app/db/db.sqlite"
  04_run_migrations:
    command: "php database/migrate.php"
  05_chown_db:
    command: "chown webapp:webapp app/db/db.sqlite"
